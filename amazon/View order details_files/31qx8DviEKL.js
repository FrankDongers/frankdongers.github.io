(function(e){var b=window.AmazonUIPageJS||window.P,l=b._namespace||b.attributeErrors,a=l?l("InTransitActionsBuzzAssets",""):b;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,b,l){"use strict";e.register("in-transit-csm-metrics-utils",function(){var a,h;try{a=navigator.userAgent}catch(c){a=""}a&&(a=a.toLowerCase(),(a=a.match(/(chrome|firefox|safari|trident|ddge|opr|crios|fxios)/gi))&&0<a.length&&(-1<a.indexOf("safari")&&1<a.length?-1<a.indexOf("chrome")||-1<a.indexOf("crios")?
h="chrome":-1<a.indexOf("fxios")&&(h="firefox"):h=a[0]));var d=[],m=function(c){b.ue&&b.uex&&uex("ld",c,{wb:1});c=d.indexOf(c);-1<c&&d.splice(c,1)};b.addEventListener("beforeunload",function(c){for(;0<d.length;)m(d[0])});return{setScope:function(c){b.ue&&b.uet&&b.uet("tc",c);return c},setPreAjax:function(c){b.ue&&b.ues&&b.ues("t0",c,new Date)},setPostAjax:function(c){b.ue&&b.uet&&b.uet("be",c)},sendAjaxMetrics:function(c){b.ue&&b.uex&&b.uex("ld",c)},recordReftag:function(c,b){c.ajax({type:"POST",
url:"/gp/mobile/tag?"+b,success:function(c){console.log("record ref tag ajax call success: ",c)},error:function(c){console.log("ref tag ajax call error: ",c)}})},logFatal:function(c){if(b.ueLogError){var a=c.feature||"pt2-fatal-generic";b.ueLogError(c.error||{message:c.message||a},{logLevel:"FATAL",attribution:a})}},logError:function(c){if(b.ueLogError){var a=c.feature||"pt2-error-generic";b.ueLogError(c.error||{message:c.message||a},{logLevel:"ERROR",attribution:a})}},logWarn:function(c){if(b.ueLogError){var a=
c.feature||"pt2-warn-generic";b.ueLogError(c.error||{message:c.message||a},{logLevel:"WARN",attribution:a})}},incrementCount:function(c,a){b.ue&&b.ue.count&&(b.ue.count(c,(b.ue.count(c)||0)+1),a&&a.browser&&h&&b.ue.count(c+"-"+h,(b.ue.count(c+"-"+h)||0)+1))},startWidgetTimer:function(c){b.ue&&b.uet&&0>d.indexOf(c)&&(uet("bb",c,{wb:1}),d.push(c))},stopWidgetTimer:m}});"use strict";e.when("A").register("in-transit-url-utils",function(a){function b(a){return a.split("\x26").reduce(function(c,a){a=a.split("\x3d").map(function(a){return decodeURIComponent(a.replace(/\+/g,
" "))});c[a[0]]=a[1];return c},{})}var d=a.$;return{getQueryParameterFromUrl:function(a,c){a=-1<a.indexOf("?")?a.substr(a.indexOf("?")):"";-1<a.indexOf("#")&&(a=a.substring(0,a.indexOf("#")));a=b(a);return a[c]?a[c]:!1},addQueryParameterToUrl:function(a,c){var b=!1;-1<a.indexOf("#")&&(b=a.substring(a.indexOf("#")),a=a.substr(0,a.indexOf("#")));c=d.param(c);a=-1<a.indexOf("?")?a+("\x26"+c):a+("?"+c);return b?a+b:a}}});"use strict";e.when("A","in-transit-csm-metrics-utils","ready").register("in-transit-sign-in-again-or-do",
function(a,h){var d=-1!==b.location.host.indexOf("hp-shoppingportal")?"/portal/cstrac/progress-tracker/actions/is-authenticated":"/progress-tracker/package/actions/is-authenticated",m;return function(c,h,e,g,n){a.post(d,{params:{csrfToken:g.csrfToken},success:function(a){a.success&&a.value?n&&n():a.success?(a=c.$currentTarget,g.width=620>b.innerWidth?.75*b.innerWidth:600,g.name=e,g.dataStrategy="preload",m||(m=h.create(a,g)),m.update({header:g.header||""}).show()):console.log("service failed")},error:function(a){}})}});
"use strict";e.when("A","in-transit-csm-metrics-utils","a-tooltip","ready").register("in-transit-tooltip",function(a,b,d){function e(a){b.incrementCount(a+"-total");g&&(b.incrementCount(a+"-unique"),g=!1)}function c(a){k("body").addClass("in-transit-tooltip-style-override "+q.deviceType);k(".in-transit-tooltip-trigger."+a).attr("title","")}var k=a.$,q=a.state("page-state")||{},g=!0,n=function(b){a.declarative("a-tooltip","mouseenter",function(a){c(b);e(b)});a.declarative("a-tooltip","click",function(a){a.$event.preventDefault()})},
t=function(b){a.declarative("a-tooltip","click",function(a){c(b);a=k(".in-transit-tooltip-trigger."+b);a=d.get(a);a.isVisible()?a.hide():e(b)})};return function(a){"desktop"!==q.deviceType&&q.deviceType?t(a):n(a)}});"use strict";e.when("A","a-modal","a-button","jQuery","in-transit-url-utils","in-transit-csm-metrics-utils","in-transit-tooltip","ready").register("rescheduleCalendarDelivery",function(a,h,d,e,c,k,q){function g(){a.state.parse();p=a.state("page-state")||{};w=l();r=x+w;y=1==p.stringDebug;
v=f("#reschedule-calendar-page-container").hasClass("r2w");f(".in-transit-tooltip-trigger.reschedule-tooltip-trigger").length&&q("reschedule-tooltip-trigger");n();u()}function n(){var a=f(".reschedule-day.enabled"),c=f(".delivery-window"),d=f(".day-choice-button",".reschedule-day.enabled"),e=f(".window-choice-button",".delivery-window.enabled"),h=f(".reschedule-go-back"),g=f(".reschedule-month-label"),k=f(".calendar-inner-month-name");d.click(function(b){b=f(this).parent();if(!b.hasClass("selected")){a.removeClass("selected").attr("aria-checked",
"false");b.addClass("selected").attr("aria-checked","true");var d=b.data("day-number"),d=f("#delivery-window-for_"+d),e=b.data("month-title");g.text()!==e&&g.text(e);k.show().filter(function(a){return this.getAttribute("data-for-month-title")===e}).hide();c.removeClass("selected").attr("aria-checked","false");v?d.addClass("visible").siblings().removeClass("visible"):d.find(".delivery-window").addClass("selected").attr("aria-checked","true");u()}});e.click(function(a){a=f(this).parent();a.hasClass("selected")||
(c.removeClass("selected").attr("aria-checked","false"),a.addClass("selected").attr("aria-checked","true"),u())});h.click(function(){b.history&&"function"===typeof b.history.back&&b.history.back()})}function t(){var a=f(".delivery-window.selected"),b={day:null,window:null,tokenId:null};if(1!==f(".reschedule-day.selected").length||1!==a.length)return b;b.day=a.first().text();b.window=a.first().text();b.tokenId=a.first().data("token");return b}function u(){var a=d("#reschedule-submit-button"),b=t();
b.tokenId&&null!==b.tokenId?a.enable():a.disable()}function l(){return"?"+f.param({orderId:p.orderId,shipmentId:p.shipmentId,packageIndex:p.packageIndex})+"\x26amzlMessageId\x3d"}var f=a.$,p=a.state("page-state")||{},x=-1!==b.location.host.indexOf("hp-shoppingportal")?"/portal/cstrac/progress-tracker":"/progress-tracker/package",z=x+"/actions/in-transit/reschedule",A={isModalContent:"1"},w=l(),r=x+w,y=1==p.stringDebug,v=f("#reschedule-calendar-page-container").hasClass("r2w");a.declarative("intransit-reschedule-open-modal",
"click",function(d){d.$event.preventDefault();var e=d.$currentTarget;e.find("a").data("ref");d=a.extend({},d.data);d.width=620>b.innerWidth?.75*b.innerWidth:600;d.name="rescheduleCalendarModal";d.dataStrategy="ajax";"#"===e.find("a").attr("href")?d.url=e.find("a").attr("data-modalurl"):d.url=e.find("a").attr("href");d.url=c.addQueryParameterToUrl(d.url,A);h.create(e,d).show()});u();g();a.on("a:popover:ajaxContentLoaded:rescheduleCalendarModal",g);a.declarative("submit-reschedule","click",function(c){c.$event.preventDefault();
c=d("#reschedule-submit-button");if(!1!==c.isEnabled()){c.disable();var e=t().tokenId;c=v?"R2W":"R2D";"undefined"===typeof e||null===e||"undefined"===e?(e=v?"request-reschedule-ajax-call-window-toggle-token-not-set":"request-reschedule-ajax-call-token-never-attempted-to-set",k.logError({feature:e,message:"The reschedule token was not set before submitting ("+c+")"}),k.incrementCount(e),b.location=r+"8"):a.post(z,{params:{rescheduleToken:e,stringDebug:y,csrfToken:b.csrfToken},dataType:"json",success:function(a){var c=
a.requestRescheduleDisplayResponse;if(a.success)k.incrementCount("request-reschedule-ajax-call-success"),b.location=r+"7";else{k.incrementCount("request-reschedule-ajax-call-failure");var c=(c=c.failureReason)||0,d="";c&&(d=", failureReason: "+c);k.logError({feature:"request-reschedule-ajax-call-failure-log",message:"Failed to request reschedule due to responseCode: "+a.responseCode+d});b.location=r+"8"}},error:function(a){k.incrementCount("request-reschedule-ajax-call-error");k.logError({feature:"request-reschedule-ajax-call-error-log",
message:("Error making a request to reschedule with",a)});b.location=r+"8"}})}})});"use strict";e.when("A","in-transit-url-utils","rescheduleDelivery","ready").execute("in-transit-loaded",function(a,e){var d=["PackageProgressTracker"];"desktop"===(a.state("page-state")||{}).deviceType&&(e=e.getQueryParameterFromUrl(b.location.search||b.location.href,"showModal"))&&-1<d.indexOf(b.uept.pageType||"")&&(d=e.replace(/[^0-9a-z\-\_]/gi,""),a=a.$("[data-action\x3d"+d+"]"),1===a.length&&a.click())})});